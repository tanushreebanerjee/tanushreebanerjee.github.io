<!DOCTYPE html>
<meta charset="utf-8" emacsmode="-*- markdown -*-">
<link rel="stylesheet" href="https://casual-effects.com/markdeep/latest/journal.css?">
<style>
/* Burgundy color theme override */
.md h1, .md h2, .md h3, .md h4, .md h5, .md h6 { color: #8B1538; }
.md a { color: #8B1538; }
.md a:hover { color: #A0446C; }

/* System fonts matching personal website */
body, .md { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif, sans-serif; }
</style>

<!-- Markdeep: https://casual-effects.com/markdeep/ -->

# Structure-from-Motion

**Module 3.2** | [‚Üê Back to Index](../index.html) | [Next: Multi-View Stereo ‚Üí](03-3d-mvs.md.html)

---

## Overview

Structure-from-Motion (SfM): Recover 3D structure and camera poses from multiple uncalibrated images.

---

## Key Papers

### üî• COLMAP

[colmap.github.io](https://colmap.github.io/)

**Open-source SfM pipeline.**

**Pipeline:**
1. **Feature detection**: Detect keypoints (SIFT)
2. **Feature matching**: Match features across images
3. **Incremental reconstruction**: Add images one by one
4. **Bundle adjustment**: Jointly optimize cameras and points
5. **Dense reconstruction**: Multi-view stereo (optional)

**Outputs:**
- Camera poses (rotation, translation, intrinsics)
- 3D point cloud (sparse)
- Visibility information

[Figure placeholder: COLMAP reconstruction pipeline diagram]

---

### OpenMVG

Open-source SfM library with modular architecture.

---

### Bundler

Early SfM software using bundle adjustment.

---

## Core Concepts

### Incremental SfM

**Process:**
1. Initialize with two images (find fundamental matrix, triangulate)
2. Register new images (PnP problem)
3. Triangulate new 3D points
4. Bundle adjustment after each addition
5. Filter outliers

**Advantages**: Robust, handles large image collections.

**Disadvantages**: Sequential, sensitive to initialization.

---

### Global SfM

**Process:**
1. Compute all pairwise relative poses
2. Global rotation averaging
3. Global translation averaging
4. Bundle adjustment

**Advantages**: More robust to drift, parallelizable.

**Disadvantages**: More complex, sensitive to outliers.

---

### Bundle Adjustment

**Goal**: Jointly optimize camera parameters and 3D structure.

**Cost function**: Sum of squared reprojection errors:
$$\sum_i \sum_j \rho(||x_{ij} - \pi(P_i, X_j)||^2)$$

Where:
- $x_{ij}$: Observed 2D point
- $\pi(P_i, X_j)$: Projection of 3D point $X_j$ by camera $P_i$
- $\rho$: Robust cost function (Huber loss)

**Optimization**: Levenberg-Marquardt algorithm.

**Sparse structure**: Schur complement for efficient solving.

---

### Image Registration

**Perspective-n-Point (PnP)**: Estimate camera pose from 2D-3D correspondences.

**Minimal solvers**: P3P (3 points), P4P, P5P.

**RANSAC**: Robust estimation in presence of outliers.

---

## Implementation Details

### Feature Matching

**SIFT features**: Scale-invariant, robust matching.

**Vocabulary tree**: Fast approximate nearest neighbors for large image collections.

**Covisibility graph**: Track which images share features.

---

### Triangulation

**Linear triangulation**: Solve for 3D point from multiple views.

**Optimization**: Non-linear refinement of reprojection error.

**Cheirality check**: Ensure points are in front of cameras.

---

## Problems Solved by Structure-from-Motion

### Camera Pose Estimation from Images
**Problem**: Determine camera positions and orientations from unordered image collections. Critical for 3D reconstruction, but requires solving complex geometric problem.

**SfM solution**: Robustly estimates camera poses and sparse 3D structure from feature correspondences. Handles arbitrary camera configurations, unordered images.

[Figure placeholder: Visualization showing unordered image collection ‚Üí feature matching ‚Üí camera pose estimation ‚Üí sparse 3D point cloud]

### Handling Large-Scale Image Collections
**Problem**: Reconstructing 3D from hundreds or thousands of images requires efficient algorithms and robust optimization.

**COLMAP solution**: Efficient incremental or global SfM handles large-scale image collections. Vocabulary tree for fast image retrieval, incremental reconstruction for scalability.

### Robustness to Outliers
**Problem**: Feature matching produces outliers. Outlier correspondences can corrupt reconstruction.

**Solution**: RANSAC-based robust estimation, robust bundle adjustment. Handles significant outlier percentages.

### Unknown Camera Parameters
**Problem**: Camera intrinsics (focal length, distortion) may be unknown, especially for consumer cameras or historical photos.

**Self-calibration solution**: Can estimate camera intrinsics along with poses. Handles varying focal lengths across images.

---

## Remaining Challenges and Limitations

### Textureless Regions
**Problem**: Images with little texture (sky, plain walls) produce few or no features. Reconstruction fails in these regions.

**Open question**: Better handling of textureless regions? Alternative features?

### Repetitive Patterns
**Problem**: Repetitive structures (windows, tiles) can cause feature matching errors. Many similar features.

**Remaining**: Challenging to disambiguate repetitive patterns. Can cause reconstruction errors.

### Dynamic Scenes
**Problem**: Moving objects violate static scene assumption. Can cause errors or need to be filtered out.

**Open question**: Better handling of dynamic scenes? Simultaneous reconstruction of static and dynamic elements?

### Large Baselines
**Problem**: Images with very large camera baselines (wide separation) can fail to match. Feature appearance changes too much.

**Remaining**: Limits reconstruction from widely separated viewpoints.

### Computational Cost
**Problem**: Large image collections can require significant computation time, especially for global SfM.

**Current solutions**: Efficient algorithms, incremental reconstruction, but still time-consuming for very large collections.

**Open question**: Faster algorithms for very large-scale reconstruction?

### Missing Geometry
**Problem**: SfM produces sparse point cloud. Many scene regions not reconstructed (occlusions, missing views).

**Solution**: MVS (Module 3.3) provides dense reconstruction, but requires SfM first.

---

## Broader Insights and Implications

### The Fundamental Role of SfM
**Insight**: SfM is foundation for many 3D vision tasks. Provides camera poses needed for dense reconstruction, neural rendering, SLAM.

**Broader impact**: SfM is prerequisite for many modern methods (NeRF, Gaussian Splatting need camera poses). Demonstrates that classical methods still crucial.

### Geometry-Based vs Learning-Based
**Insight**: SfM demonstrates power of geometric reasoning. Well-established geometry, optimization, robust estimation techniques.

**Broader impact**: Shows that not everything needs deep learning. Geometry-based methods still valuable. Combination (geometry + learning) often best.

### Robust Estimation in Practice
**Insight**: SfM requires robust estimation at multiple stages (matching, pose estimation, bundle adjustment). RANSAC, robust cost functions crucial.

**Broader impact**: Highlights importance of robustness in real-world applications. Outliers always present. Robust estimation essential.

### The Sparse-to-Dense Pipeline
**Insight**: SfM produces sparse reconstruction, then MVS makes it dense. This two-stage pipeline (sparse ‚Üí dense) is common pattern.

**Broader impact**: Demonstrates value of multi-stage pipelines. Each stage optimized for different goals. Influences design of other reconstruction methods.

### Open-Source Tool Success
**Insight**: COLMAP's success demonstrates value of high-quality open-source tools. Enables wide adoption and research progress.

**Broader impact**: Shows importance of tools and infrastructure. Good tools accelerate research. Influences development of other open-source tools.

[Placeholder for manual expansion: Add insights about impact on research, connections to modern neural methods, future directions]

---

## Applications

- 3D reconstruction from photo collections
- Photogrammetry
- Virtual tourism (reconstruct landmarks)
- Preprocessing for NeRF (COLMAP provides camera poses)

[Figure placeholder: Applications diagram showing SfM used in photogrammetry, virtual tourism, NeRF preprocessing, etc.]

---

## Related Modules

- Module 3.1: Geometry & Camera Models
- Module 3.3: Multi-View Stereo (uses SfM camera poses)
- Module 5.1: NeRF (uses SfM poses as initialization)

---

## Additional Resources

- **COLMAP Documentation**: [colmap.github.io](https://colmap.github.io/)
- **VisualSfM**: GUI-based SfM tool

---

<div style="text-align: center; margin-top: 2em;">
[‚Üê Back to Index](../index.html) | [Next: Multi-View Stereo ‚Üí](03-3d-mvs.md.html)
</div>

<!-- Markdeep: --><style class="fallback">body{visibility:hidden;white-space:pre;font-family:monospace}</style><script src="markdeep.min.js" charset="utf-8"></script><script src="https://morgan3d.github.io/markdeep/latest/markdeep.min.js" charset="utf-8"></script><script>window.alreadyProcessedMarkdeep||(document.body.style.visibility="visible")</script>
